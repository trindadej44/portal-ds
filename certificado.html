<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Certificado</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: url('https://getwallpapers.com/wallpaper/full/b/4/5/75063.jpg') no-repeat center center fixed;
            background-size: cover;
            color: #fff;
            text-align: center;
            overflow: hidden;
            position: relative;
        }

        h1 {
            font-size: 3.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }

        .certificate-container {
            display: flex;
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            background-color: rgba(20, 20, 40, 0.9);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            position: relative;
            z-index: 1;
        }

        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: rgba(255, 140, 0, 0.8);
            color: #fff;
            transition: background-color 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }

        .back-button:hover {
            background-color: rgba(255, 140, 0, 1);
        }

        button {
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: rgba(255, 140, 0, 0.8);
            color: #fff;
            transition: background-color 0.3s ease;
            margin-top: 20px;
            margin: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }

        button:hover {
            background-color: rgba(255, 140, 0, 1);
        }

        .label {
            font-weight: bold;
            color: #fff;
        }

        #loader {
            display: none;
            font-size: 1.2em;
            color: #fff;
        }

        #user-info {
            margin-top: 20px;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0.8;
            pointer-events: none;
            animation: fall linear forwards;
        }

        @keyframes fall {
            0% {
                transform: translateY(0) rotate(0deg);
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        .Documents-btn {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            width: fit-content;
            height: 45px;
            border: none;
            padding: 0px 15px;
            border-radius: 5px;
            background-color: rgba(49, 49, 83, 0.9);
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .folderContainer {
            width: 40px;
            height: fit-content;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            position: relative;
        }

        .fileBack {
            z-index: 1;
            width: 80%;
            height: auto;
        }

        .filePage {
            width: 50%;
            height: auto;
            position: absolute;
            z-index: 2;
            transition: all 0.3s ease-out;
        }

        .fileFront {
            width: 85%;
            height: auto;
            position: absolute;
            z-index: 3;
            opacity: 0.95;
            transform-origin: bottom;
            transition: all 0.3s ease-out;
        }

        .text {
            color: #fff;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .Documents-btn:hover .filePage {
            transform: translateY(-5px);
        }

        .Documents-btn:hover {
            background-color: rgba(58, 58, 94, 0.9);
        }

        .Documents-btn:active {
            transform: scale(0.95);
        }

        .Documents-btn:hover .fileFront {
            transform: rotateX(30deg);
        }
    </style>
</head>
<body>

    <button class="back-button" id="backToDashboard">ðŸ”™ Voltar para o Dashboard</button>

    <div class="certificate-container">
        <h1 style="color: #ffae00;">ðŸŽ‰ðŸ¥³ ParabÃ©ns! ðŸŽ‰ðŸ¥³ </h1>
        <p>VocÃª concluiu os trÃªs mÃ³dulos do curso, e agora pode emitir o seu certificado!</p>
        <button class="Documents-btn" id="generate">
            <span class="folderContainer">
                <svg class="fileBack" width="146" height="113" viewBox="0 0 146 113" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0 4C0 1.79086 1.79086 0 4 0H50.3802C51.8285 0 53.2056 0.627965 54.1553 1.72142L64.3303 13.4371C65.2799 14.5306 66.657 15.1585 68.1053 15.1585H141.509C143.718 15.1585 145.509 16.9494 145.509 19.1585V109C145.509 111.209 143.718 113 141.509 113H3.99999C1.79085 113 0 111.209 0 109V4Z" fill="url(#paint0_linear_117_4)"></path>
                    <defs>
                        <linearGradient id="paint0_linear_117_4" x1="0" y1="0" x2="72.93" y2="95.4804" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#8F88C2"></stop>
                            <stop offset="1" stop-color="#5C52A2"></stop>
                        </linearGradient>
                    </defs>
                </svg>
                <svg class="filePage" width="88" height="99" viewBox="0 0 88 99" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="88" height="99" fill="url(#paint0_linear_117_6)"></rect>
                    <defs>
                        <linearGradient id="paint0_linear_117_6" x1="0" y1="0" x2="81" y2="160.5" gradientUnits="userSpaceOnUse">
                            <stop stop-color="white"></stop>
                            <stop offset="1" stop-color="#686868"></stop>
                        </linearGradient>
                    </defs>
                </svg>
                <svg class="fileFront" width="160" height="79" viewBox="0 0 160 79" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0.29306 12.2478C0.133905 9.38186 2.41499 6.97059 5.28537 6.97059H30.419H58.1902C59.5751 6.97059 60.9288 6.55982 62.0802 5.79025L68.977 1.18034C70.1283 0.410771 71.482 0 72.8669 0H77H155.462C157.87 0 159.733 2.1129 159.733 4.5V80.5C159.733 82.8871 157.87 85 155.462 85H0C-2.41394 85 -3.01462 82.8871 -3.01462 80.5V12.2478Z" fill="url(#paint0_linear_117_8)"></path>
                    <defs>
                        <linearGradient id="paint0_linear_117_8" x1="0" y1="0" x2="108" y2="107.775" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#FFB300"></stop>
                            <stop offset="1" stop-color="#FFC700"></stop>
                        </linearGradient>
                    </defs>
                </svg>
            </span>
            <span class="text">Gerar Certificado</span>
        </button>
        <div id="loader">Gerando seu certificado...</div>
        <div id="user-info"></div>
    </div>
    

    <script>
        // FunÃ§Ã£o para criar confete
        function createConfetti() {
            const colors = ['#FFC700', '#FF6F00', '#FF3D00', '#FF009E', '#4A00E0'];
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.animationDuration = (Math.random() * 1 + 2) + 's';
            confetti.style.width = Math.random() * 10 + 5 + 'px'; // Aumenta o tamanho
            confetti.style.height = confetti.style.width; // MantÃ©m a proporÃ§Ã£o
            document.body.appendChild(confetti);

            // Remove o confete apÃ³s a animaÃ§Ã£o
            confetti.addEventListener('animationend', () => {
                confetti.remove();
            });
        }

        // Gera confete em intervalos
        setInterval(createConfetti, 100); // Aumenta a frequÃªncia

        let nomeEstudante = ""; // VariÃ¡vel para armazenar o nome do estudante

        fetch('http://localhost:3001/api/user-info')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                document.getElementById('loader').style.display = 'none'; // Esconder loader
                const userInfoElement = document.getElementById('user-info');
                userInfoElement.style.display = 'block'; // Mostrar informaÃ§Ãµes do usuÃ¡rio
                /*userInfoElement.innerHTML = `
                    <span class="label">Nome:</span> ${data.name}<br>
                    <span class="label">Email:</span> ${data.email}<br>
                    <span class="label">Telefone:</span> ${data.phone ? data.phone : 'NÃ£o cadastrado'}
                `;*/

                // Armazenar o nome do estudante na variÃ¡vel
                nomeEstudante = data.name;
            })
            .catch(error => {
                console.error('Houve um problema com a requisiÃ§Ã£o:', error);
                document.getElementById('loader').style.display = 'none'; // Esconder loader
                document.getElementById('user-info').innerHTML = 'Erro ao carregar informaÃ§Ãµes.';
            });

        // BotÃ£o de voltar para o dashboard
        document.getElementById('backToDashboard').addEventListener('click', function() {
            window.location.href = 'dashboard.html'; // Altere para o caminho do seu dashboard
        });
    </script>

    <script>
        document.getElementById('generate').addEventListener('click', async function() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('landscape');

            // Adiciona a imagem da moldura (bordas)
            const moldura = 'images/essevai.png'; // Caminho da imagem da moldura
            await doc.addImage(moldura, 'PNG', 0, 0, 297, 220); 

            // Adiciona a imagem da medalha (lado esquerdo)
            const medalha = 'images/tecverso-logo-neon.png';
            await doc.addImage(medalha, 'PNG', 15, 30, 60, 40); 

            // TÃ­tulo do certificado
            doc.setFontSize(16);
            doc.setFont('helvetica', 'normal');
            doc.text("Este certificado Ã© concedido a:", 148.5, 100, null, null, 'center');
            
            // Nome do estudante usando a variÃ¡vel
            doc.setFont('courier', 'normal'); // Usando a fonte Courier
            doc.setFontSize(22);
            doc.text(nomeEstudante, 148.5, 120, null, null, 'center');

            // Nome do curso
            const nomeCurso = "Github Desktop"; 
            doc.setFontSize(16);
            doc.setFont('helvetica', 'normal');
            doc.text(`Pelo curso de ${nomeCurso}`, 148.5, 140, null, null, 'center');

            // Salvar o PDF
            doc.save('certificado.pdf');
        });
    </script>
    
</body>
</html>
